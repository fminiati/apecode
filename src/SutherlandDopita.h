#ifndef SUTHERLANDDOPITA_H
#define SUTHERLANDDOPITA_H

#include <cstdlib>
#include <cassert>
#include <vector>
#include <list>
#include <string>
#include <cstring>
#include <cmath>
#include <ios>
#include <iomanip>
#include <iostream>
#include <fstream>

#ifdef USE_TIMER
#include "Timer.h" // available at https://github.com/fminiati/mthread-timer
using namespace fm::profiling;
#else
template <unsigned T=0> struct Timer_t {
    Timer_t(std::string &&){};
};
#endif

namespace fm::cooling_tables {

  constexpr double zero = 0.0e0;
  constexpr double one = 1.0e0;
  constexpr double ten = 1.0e1;

  static const int s_num_metal_bins = 8; // last is supersolar
  static const int s_num_temp_bins = 90;
  
  static const double s_log_met_tab[]={1.e-10,-3.0,-2.0,-1.5,-1.0,-0.5,0.0,0.5};
  //const string sd_file_names[]={"mzero.cie","m-30.cie","m-20.cie","m-10.cie","m-05.cie","m-00.cie"};
  
  static const double s_cooling_met_cie_tab[s_num_metal_bins][s_num_temp_bins][4]=  {
    // mzero.cie
    {
      { 4.00e+00,  2.000e-03,  1.064e+00, -2.604e+01 },
      { 4.05e+00,  1.400e-02,  1.064e+00, -2.469e+01 },
      { 4.10e+00,  7.000e-02,  1.064e+00, -2.353e+01 },
      { 4.15e+00,  2.530e-01,  1.064e+00, -2.263e+01 },
      { 4.20e+00,  5.670e-01,  1.064e+00, -2.212e+01 },
      { 4.25e+00,  8.160e-01,  1.064e+00, -2.198e+01 },
      { 4.30e+00,  9.310e-01,  1.064e+00, -2.203e+01 },
      { 4.35e+00,  9.760e-01,  1.064e+00, -2.213e+01 },
      { 4.40e+00,  9.980e-01,  1.064e+00, -2.224e+01 },
      { 4.45e+00,  1.020e+00,  1.064e+00, -2.233e+01 },
      { 4.50e+00,  1.042e+00,  1.064e+00, -2.241e+01 },
      { 4.55e+00,  1.055e+00,  1.064e+00, -2.249e+01 },
      { 4.60e+00,  1.060e+00,  1.064e+00, -2.258e+01 },
      { 4.65e+00,  1.062e+00,  1.064e+00, -2.264e+01 },
      { 4.70e+00,  1.064e+00,  1.064e+00, -2.265e+01 },
      { 4.75e+00,  1.065e+00,  1.064e+00, -2.257e+01 },
      { 4.80e+00,  1.070e+00,  1.064e+00, -2.241e+01 },
      { 4.85e+00,  1.082e+00,  1.064e+00, -2.224e+01 },
      { 4.90e+00,  1.099e+00,  1.064e+00, -2.216e+01 },
      { 4.95e+00,  1.113e+00,  1.064e+00, -2.217e+01 },
      { 5.00e+00,  1.121e+00,  1.064e+00, -2.225e+01 },
      { 5.05e+00,  1.125e+00,  1.064e+00, -2.236e+01 },
      { 5.10e+00,  1.126e+00,  1.064e+00, -2.246e+01 },
      { 5.15e+00,  1.127e+00,  1.064e+00, -2.256e+01 },
      { 5.20e+00,  1.128e+00,  1.064e+00, -2.266e+01 },
      { 5.25e+00,  1.128e+00,  1.064e+00, -2.274e+01 },
      { 5.30e+00,  1.128e+00,  1.064e+00, -2.282e+01 },
      { 5.35e+00,  1.128e+00,  1.064e+00, -2.289e+01 },
      { 5.40e+00,  1.128e+00,  1.064e+00, -2.295e+01 },
      { 5.45e+00,  1.128e+00,  1.064e+00, -2.301e+01 },
      { 5.50e+00,  1.128e+00,  1.064e+00, -2.305e+01 },
      { 5.55e+00,  1.128e+00,  1.064e+00, -2.309e+01 },
      { 5.60e+00,  1.128e+00,  1.064e+00, -2.313e+01 },
      { 5.65e+00,  1.128e+00,  1.064e+00, -2.316e+01 },
      { 5.70e+00,  1.128e+00,  1.064e+00, -2.318e+01 },
      { 5.75e+00,  1.128e+00,  1.064e+00, -2.320e+01 },
      { 5.80e+00,  1.128e+00,  1.064e+00, -2.322e+01 },
      { 5.85e+00,  1.128e+00,  1.064e+00, -2.323e+01 },
      { 5.90e+00,  1.128e+00,  1.064e+00, -2.324e+01 },
      { 5.95e+00,  1.128e+00,  1.064e+00, -2.325e+01 },
      { 6.00e+00,  1.128e+00,  1.064e+00, -2.325e+01 },
      { 6.05e+00,  1.128e+00,  1.064e+00, -2.325e+01 },
      { 6.10e+00,  1.128e+00,  1.064e+00, -2.325e+01 },
      { 6.15e+00,  1.128e+00,  1.064e+00, -2.325e+01 },
      { 6.20e+00,  1.128e+00,  1.064e+00, -2.325e+01 },
      { 6.25e+00,  1.128e+00,  1.064e+00, -2.324e+01 },
      { 6.30e+00,  1.128e+00,  1.064e+00, -2.323e+01 },
      { 6.35e+00,  1.128e+00,  1.064e+00, -2.323e+01 },
      { 6.40e+00,  1.128e+00,  1.064e+00, -2.323e+01 },
      { 6.45e+00,  1.128e+00,  1.064e+00, -2.321e+01 },
      { 6.50e+00,  1.128e+00,  1.064e+00, -2.320e+01 },
      { 6.55e+00,  1.128e+00,  1.064e+00, -2.319e+01 },
      { 6.60e+00,  1.128e+00,  1.064e+00, -2.318e+01 },
      { 6.65e+00,  1.128e+00,  1.064e+00, -2.316e+01 },
      { 6.70e+00,  1.128e+00,  1.064e+00, -2.315e+01 },
      { 6.75e+00,  1.128e+00,  1.064e+00, -2.313e+01 },
      { 6.80e+00,  1.128e+00,  1.064e+00, -2.311e+01 },
      { 6.85e+00,  1.128e+00,  1.064e+00, -2.310e+01 },
      { 6.90e+00,  1.128e+00,  1.064e+00, -2.308e+01 },
      { 6.95e+00,  1.128e+00,  1.064e+00, -2.306e+01 },
      { 7.00e+00,  1.128e+00,  1.064e+00, -2.305e+01 },
      { 7.05e+00,  1.128e+00,  1.064e+00, -2.303e+01 },
      { 7.10e+00,  1.128e+00,  1.064e+00, -2.301e+01 },
      { 7.15e+00,  1.128e+00,  1.064e+00, -2.299e+01 },
      { 7.20e+00,  1.128e+00,  1.064e+00, -2.297e+01 },
      { 7.25e+00,  1.128e+00,  1.064e+00, -2.295e+01 },
      { 7.30e+00,  1.128e+00,  1.064e+00, -2.293e+01 },
      { 7.35e+00,  1.128e+00,  1.064e+00, -2.291e+01 },
      { 7.40e+00,  1.128e+00,  1.064e+00, -2.289e+01 },
      { 7.45e+00,  1.128e+00,  1.064e+00, -2.286e+01 },
      { 7.50e+00,  1.128e+00,  1.064e+00, -2.284e+01 },
      { 7.55e+00,  1.128e+00,  1.064e+00, -2.282e+01 },
      { 7.60e+00,  1.128e+00,  1.064e+00, -2.280e+01 },
      { 7.65e+00,  1.128e+00,  1.064e+00, -2.278e+01 },
      { 7.70e+00,  1.128e+00,  1.064e+00, -2.276e+01 },
      { 7.75e+00,  1.128e+00,  1.064e+00, -2.274e+01 },
      { 7.80e+00,  1.128e+00,  1.064e+00, -2.271e+01 },
      { 7.85e+00,  1.128e+00,  1.064e+00, -2.269e+01 },
      { 7.90e+00,  1.128e+00,  1.064e+00, -2.267e+01 },
      { 7.95e+00,  1.128e+00,  1.064e+00, -2.265e+01 },
      { 8.00e+00,  1.128e+00,  1.064e+00, -2.262e+01 },
      { 8.05e+00,  1.128e+00,  1.064e+00, -2.260e+01 },
      { 8.10e+00,  1.128e+00,  1.064e+00, -2.258e+01 },
      { 8.15e+00,  1.128e+00,  1.064e+00, -2.256e+01 },
      { 8.20e+00,  1.128e+00,  1.064e+00, -2.253e+01 },
      { 8.25e+00,  1.128e+00,  1.064e+00, -2.251e+01 },
      { 8.30e+00,  1.128e+00,  1.064e+00, -2.249e+01 },
      { 8.35e+00,  1.128e+00,  1.064e+00, -2.246e+01 },
      { 8.40e+00,  1.128e+00,  1.064e+00, -2.244e+01 },
      { 8.45e+00,  1.128e+00,  1.064e+00, -2.242e+01 }
    },
    // m-30.cie
    {
      { 4.00e+00,  2.000e-03,  1.064e+00, -2.604e+01 },
      { 4.05e+00,  1.400e-02,  1.064e+00, -2.469e+01 },
      { 4.10e+00,  7.000e-02,  1.064e+00, -2.353e+01 },
      { 4.15e+00,  2.530e-01,  1.064e+00, -2.263e+01 },
      { 4.20e+00,  5.670e-01,  1.064e+00, -2.212e+01 },
      { 4.25e+00,  8.160e-01,  1.064e+00, -2.198e+01 },
      { 4.30e+00,  9.310e-01,  1.064e+00, -2.203e+01 },
      { 4.35e+00,  9.760e-01,  1.064e+00, -2.213e+01 },
      { 4.40e+00,  9.980e-01,  1.064e+00, -2.224e+01 },
      { 4.45e+00,  1.020e+00,  1.064e+00, -2.233e+01 },
      { 4.50e+00,  1.042e+00,  1.064e+00, -2.240e+01 },
      { 4.55e+00,  1.055e+00,  1.064e+00, -2.249e+01 },
      { 4.60e+00,  1.060e+00,  1.064e+00, -2.257e+01 },
      { 4.65e+00,  1.062e+00,  1.064e+00, -2.263e+01 },
      { 4.70e+00,  1.064e+00,  1.064e+00, -2.263e+01 },
      { 4.75e+00,  1.065e+00,  1.064e+00, -2.255e+01 },
      { 4.80e+00,  1.070e+00,  1.064e+00, -2.239e+01 },
      { 4.85e+00,  1.082e+00,  1.064e+00, -2.223e+01 },
      { 4.90e+00,  1.099e+00,  1.064e+00, -2.215e+01 },
      { 4.95e+00,  1.113e+00,  1.064e+00, -2.216e+01 },
      { 5.00e+00,  1.121e+00,  1.064e+00, -2.224e+01 },
      { 5.05e+00,  1.125e+00,  1.064e+00, -2.233e+01 },
      { 5.10e+00,  1.126e+00,  1.064e+00, -2.243e+01 },
      { 5.15e+00,  1.127e+00,  1.064e+00, -2.252e+01 },
      { 5.20e+00,  1.128e+00,  1.064e+00, -2.260e+01 },
      { 5.25e+00,  1.128e+00,  1.064e+00, -2.266e+01 },
      { 5.30e+00,  1.128e+00,  1.064e+00, -2.272e+01 },
      { 5.35e+00,  1.128e+00,  1.064e+00, -2.277e+01 },
      { 5.40e+00,  1.128e+00,  1.064e+00, -2.282e+01 },
      { 5.45e+00,  1.128e+00,  1.064e+00, -2.290e+01 },
      { 5.50e+00,  1.128e+00,  1.064e+00, -2.298e+01 },
      { 5.55e+00,  1.128e+00,  1.064e+00, -2.304e+01 },
      { 5.60e+00,  1.128e+00,  1.064e+00, -2.308e+01 },
      { 5.65e+00,  1.128e+00,  1.064e+00, -2.312e+01 },
      { 5.70e+00,  1.128e+00,  1.064e+00, -2.314e+01 },
      { 5.75e+00,  1.128e+00,  1.064e+00, -2.316e+01 },
      { 5.80e+00,  1.128e+00,  1.064e+00, -2.318e+01 },
      { 5.85e+00,  1.128e+00,  1.064e+00, -2.320e+01 },
      { 5.90e+00,  1.128e+00,  1.064e+00, -2.322e+01 },
      { 5.95e+00,  1.128e+00,  1.064e+00, -2.323e+01 },
      { 6.00e+00,  1.128e+00,  1.064e+00, -2.323e+01 },
      { 6.05e+00,  1.128e+00,  1.064e+00, -2.324e+01 },
      { 6.10e+00,  1.128e+00,  1.064e+00, -2.324e+01 },
      { 6.15e+00,  1.128e+00,  1.064e+00, -2.323e+01 },
      { 6.20e+00,  1.128e+00,  1.064e+00, -2.323e+01 },
      { 6.25e+00,  1.128e+00,  1.064e+00, -2.323e+01 },
      { 6.30e+00,  1.128e+00,  1.064e+00, -2.322e+01 },
      { 6.35e+00,  1.128e+00,  1.064e+00, -2.323e+01 },
      { 6.40e+00,  1.128e+00,  1.064e+00, -2.322e+01 },
      { 6.45e+00,  1.128e+00,  1.064e+00, -2.321e+01 },
      { 6.50e+00,  1.128e+00,  1.064e+00, -2.320e+01 },
      { 6.55e+00,  1.128e+00,  1.064e+00, -2.319e+01 },
      { 6.60e+00,  1.128e+00,  1.064e+00, -2.317e+01 },
      { 6.65e+00,  1.128e+00,  1.064e+00, -2.316e+01 },
      { 6.70e+00,  1.128e+00,  1.064e+00, -2.314e+01 },
      { 6.75e+00,  1.128e+00,  1.064e+00, -2.313e+01 },
      { 6.80e+00,  1.128e+00,  1.064e+00, -2.311e+01 },
      { 6.85e+00,  1.128e+00,  1.064e+00, -2.309e+01 },
      { 6.90e+00,  1.128e+00,  1.064e+00, -2.308e+01 },
      { 6.95e+00,  1.128e+00,  1.064e+00, -2.306e+01 },
      { 7.00e+00,  1.128e+00,  1.064e+00, -2.304e+01 },
      { 7.05e+00,  1.128e+00,  1.064e+00, -2.303e+01 },
      { 7.10e+00,  1.128e+00,  1.064e+00, -2.301e+01 },
      { 7.15e+00,  1.128e+00,  1.064e+00, -2.299e+01 },
      { 7.20e+00,  1.128e+00,  1.064e+00, -2.297e+01 },
      { 7.25e+00,  1.128e+00,  1.064e+00, -2.295e+01 },
      { 7.30e+00,  1.128e+00,  1.064e+00, -2.293e+01 },
      { 7.35e+00,  1.128e+00,  1.064e+00, -2.291e+01 },
      { 7.40e+00,  1.128e+00,  1.064e+00, -2.289e+01 },
      { 7.45e+00,  1.128e+00,  1.064e+00, -2.286e+01 },
      { 7.50e+00,  1.128e+00,  1.064e+00, -2.284e+01 },
      { 7.55e+00,  1.128e+00,  1.064e+00, -2.282e+01 },
      { 7.60e+00,  1.128e+00,  1.064e+00, -2.280e+01 },
      { 7.65e+00,  1.128e+00,  1.064e+00, -2.278e+01 },
      { 7.70e+00,  1.128e+00,  1.064e+00, -2.276e+01 },
      { 7.75e+00,  1.128e+00,  1.064e+00, -2.273e+01 },
      { 7.80e+00,  1.128e+00,  1.064e+00, -2.271e+01 },
      { 7.85e+00,  1.128e+00,  1.064e+00, -2.269e+01 },
      { 7.90e+00,  1.128e+00,  1.064e+00, -2.267e+01 },
      { 7.95e+00,  1.128e+00,  1.064e+00, -2.265e+01 },
      { 8.00e+00,  1.128e+00,  1.064e+00, -2.262e+01 },
      { 8.05e+00,  1.128e+00,  1.064e+00, -2.260e+01 },
      { 8.10e+00,  1.128e+00,  1.064e+00, -2.258e+01 },
      { 8.15e+00,  1.128e+00,  1.064e+00, -2.256e+01 },
      { 8.20e+00,  1.128e+00,  1.064e+00, -2.253e+01 },
      { 8.25e+00,  1.128e+00,  1.064e+00, -2.251e+01 },
      { 8.30e+00,  1.128e+00,  1.064e+00, -2.249e+01 },
      { 8.35e+00,  1.128e+00,  1.064e+00, -2.246e+01 },
      { 8.40e+00,  1.128e+00,  1.064e+00, -2.244e+01 },
      { 8.45e+00,  1.128e+00,  1.064e+00, -2.242e+01 }
    },
    // m-20.cie
    {
      { 4.00e+00,  2.000e-03,  1.064e+00, -2.603e+01 },
      { 4.05e+00,  1.400e-02,  1.064e+00, -2.468e+01 },
      { 4.10e+00,  7.000e-02,  1.064e+00, -2.353e+01 },
      { 4.15e+00,  2.530e-01,  1.064e+00, -2.263e+01 },
      { 4.20e+00,  5.670e-01,  1.064e+00, -2.212e+01 },
      { 4.25e+00,  8.160e-01,  1.064e+00, -2.198e+01 },
      { 4.30e+00,  9.310e-01,  1.064e+00, -2.202e+01 },
      { 4.35e+00,  9.760e-01,  1.064e+00, -2.212e+01 },
      { 4.40e+00,  9.980e-01,  1.064e+00, -2.223e+01 },
      { 4.45e+00,  1.020e+00,  1.064e+00, -2.231e+01 },
      { 4.50e+00,  1.042e+00,  1.064e+00, -2.237e+01 },
      { 4.55e+00,  1.055e+00,  1.064e+00, -2.244e+01 },
      { 4.60e+00,  1.060e+00,  1.064e+00, -2.249e+01 },
      { 4.65e+00,  1.062e+00,  1.064e+00, -2.251e+01 },
      { 4.70e+00,  1.064e+00,  1.064e+00, -2.249e+01 },
      { 4.75e+00,  1.065e+00,  1.064e+00, -2.240e+01 },
      { 4.80e+00,  1.070e+00,  1.064e+00, -2.227e+01 },
      { 4.85e+00,  1.082e+00,  1.064e+00, -2.213e+01 },
      { 4.90e+00,  1.099e+00,  1.064e+00, -2.205e+01 },
      { 4.95e+00,  1.113e+00,  1.064e+00, -2.205e+01 },
      { 5.00e+00,  1.121e+00,  1.064e+00, -2.210e+01 },
      { 5.05e+00,  1.125e+00,  1.064e+00, -2.216e+01 },
      { 5.10e+00,  1.127e+00,  1.064e+00, -2.221e+01 },
      { 5.15e+00,  1.127e+00,  1.064e+00, -2.223e+01 },
      { 5.20e+00,  1.128e+00,  1.064e+00, -2.225e+01 },
      { 5.25e+00,  1.128e+00,  1.064e+00, -2.226e+01 },
      { 5.30e+00,  1.128e+00,  1.064e+00, -2.226e+01 },
      { 5.35e+00,  1.128e+00,  1.064e+00, -2.226e+01 },
      { 5.40e+00,  1.128e+00,  1.064e+00, -2.230e+01 },
      { 5.45e+00,  1.128e+00,  1.064e+00, -2.242e+01 },
      { 5.50e+00,  1.128e+00,  1.064e+00, -2.259e+01 },
      { 5.55e+00,  1.128e+00,  1.064e+00, -2.274e+01 },
      { 5.60e+00,  1.128e+00,  1.064e+00, -2.282e+01 },
      { 5.65e+00,  1.128e+00,  1.064e+00, -2.286e+01 },
      { 5.70e+00,  1.128e+00,  1.064e+00, -2.287e+01 },
      { 5.75e+00,  1.128e+00,  1.064e+00, -2.289e+01 },
      { 5.80e+00,  1.128e+00,  1.064e+00, -2.293e+01 },
      { 5.85e+00,  1.128e+00,  1.064e+00, -2.300e+01 },
      { 5.90e+00,  1.128e+00,  1.064e+00, -2.306e+01 },
      { 5.95e+00,  1.128e+00,  1.064e+00, -2.309e+01 },
      { 6.00e+00,  1.128e+00,  1.064e+00, -2.310e+01 },
      { 6.05e+00,  1.128e+00,  1.064e+00, -2.312e+01 },
      { 6.10e+00,  1.128e+00,  1.064e+00, -2.312e+01 },
      { 6.15e+00,  1.128e+00,  1.064e+00, -2.312e+01 },
      { 6.20e+00,  1.128e+00,  1.064e+00, -2.312e+01 },
      { 6.25e+00,  1.128e+00,  1.064e+00, -2.312e+01 },
      { 6.30e+00,  1.128e+00,  1.064e+00, -2.313e+01 },
      { 6.35e+00,  1.128e+00,  1.064e+00, -2.315e+01 },
      { 6.40e+00,  1.128e+00,  1.064e+00, -2.316e+01 },
      { 6.45e+00,  1.128e+00,  1.064e+00, -2.316e+01 },
      { 6.50e+00,  1.128e+00,  1.064e+00, -2.316e+01 },
      { 6.55e+00,  1.128e+00,  1.064e+00, -2.315e+01 },
      { 6.60e+00,  1.128e+00,  1.064e+00, -2.314e+01 },
      { 6.65e+00,  1.128e+00,  1.064e+00, -2.313e+01 },
      { 6.70e+00,  1.128e+00,  1.064e+00, -2.312e+01 },
      { 6.75e+00,  1.128e+00,  1.064e+00, -2.311e+01 },
      { 6.80e+00,  1.128e+00,  1.064e+00, -2.309e+01 },
      { 6.85e+00,  1.128e+00,  1.064e+00, -2.308e+01 },
      { 6.90e+00,  1.128e+00,  1.064e+00, -2.306e+01 },
      { 6.95e+00,  1.128e+00,  1.064e+00, -2.305e+01 },
      { 7.00e+00,  1.128e+00,  1.064e+00, -2.303e+01 },
      { 7.05e+00,  1.128e+00,  1.064e+00, -2.301e+01 },
      { 7.10e+00,  1.128e+00,  1.064e+00, -2.300e+01 },
      { 7.15e+00,  1.128e+00,  1.064e+00, -2.298e+01 },
      { 7.20e+00,  1.128e+00,  1.064e+00, -2.296e+01 },
      { 7.25e+00,  1.128e+00,  1.064e+00, -2.294e+01 },
      { 7.30e+00,  1.128e+00,  1.064e+00, -2.292e+01 },
      { 7.35e+00,  1.128e+00,  1.064e+00, -2.290e+01 },
      { 7.40e+00,  1.128e+00,  1.064e+00, -2.288e+01 },
      { 7.45e+00,  1.128e+00,  1.064e+00, -2.286e+01 },
      { 7.50e+00,  1.128e+00,  1.064e+00, -2.284e+01 },
      { 7.55e+00,  1.128e+00,  1.064e+00, -2.282e+01 },
      { 7.60e+00,  1.128e+00,  1.064e+00, -2.280e+01 },
      { 7.65e+00,  1.128e+00,  1.064e+00, -2.278e+01 },
      { 7.70e+00,  1.128e+00,  1.064e+00, -2.275e+01 },
      { 7.75e+00,  1.128e+00,  1.064e+00, -2.273e+01 },
      { 7.80e+00,  1.128e+00,  1.064e+00, -2.271e+01 },
      { 7.85e+00,  1.128e+00,  1.064e+00, -2.269e+01 },
      { 7.90e+00,  1.128e+00,  1.064e+00, -2.267e+01 },
      { 7.95e+00,  1.128e+00,  1.064e+00, -2.264e+01 },
      { 8.00e+00,  1.128e+00,  1.064e+00, -2.262e+01 },
      { 8.05e+00,  1.128e+00,  1.064e+00, -2.260e+01 },
      { 8.10e+00,  1.128e+00,  1.064e+00, -2.258e+01 },
      { 8.15e+00,  1.128e+00,  1.064e+00, -2.255e+01 },
      { 8.20e+00,  1.128e+00,  1.064e+00, -2.253e+01 },
      { 8.25e+00,  1.128e+00,  1.064e+00, -2.251e+01 },
      { 8.30e+00,  1.128e+00,  1.064e+00, -2.249e+01 },
      { 8.35e+00,  1.128e+00,  1.064e+00, -2.246e+01 },
      { 8.40e+00,  1.128e+00,  1.064e+00, -2.244e+01 },
      { 8.45e+00,  1.128e+00,  1.064e+00, -2.242e+01 }
    },
    // m-15.cie
    {
      { 4.00e+00,  2.000e-03,  1.064e+00, -2.600e+01 },
      { 4.05e+00,  1.400e-02,  1.064e+00, -2.466e+01 },
      { 4.10e+00,  7.000e-02,  1.064e+00, -2.352e+01 },
      { 4.15e+00,  2.530e-01,  1.064e+00, -2.262e+01 },
      { 4.20e+00,  5.670e-01,  1.064e+00, -2.211e+01 },
      { 4.25e+00,  8.160e-01,  1.064e+00, -2.197e+01 },
      { 4.30e+00,  9.310e-01,  1.064e+00, -2.201e+01 },
      { 4.35e+00,  9.760e-01,  1.064e+00, -2.211e+01 },
      { 4.40e+00,  9.980e-01,  1.064e+00, -2.220e+01 },
      { 4.45e+00,  1.021e+00,  1.064e+00, -2.227e+01 },
      { 4.50e+00,  1.042e+00,  1.064e+00, -2.231e+01 },
      { 4.55e+00,  1.055e+00,  1.064e+00, -2.233e+01 },
      { 4.60e+00,  1.060e+00,  1.064e+00, -2.234e+01 },
      { 4.65e+00,  1.063e+00,  1.064e+00, -2.232e+01 },
      { 4.70e+00,  1.064e+00,  1.064e+00, -2.226e+01 },
      { 4.75e+00,  1.066e+00,  1.064e+00, -2.217e+01 },
      { 4.80e+00,  1.070e+00,  1.064e+00, -2.206e+01 },
      { 4.85e+00,  1.082e+00,  1.064e+00, -2.195e+01 },
      { 4.90e+00,  1.099e+00,  1.064e+00, -2.188e+01 },
      { 4.95e+00,  1.113e+00,  1.064e+00, -2.186e+01 },
      { 5.00e+00,  1.121e+00,  1.064e+00, -2.188e+01 },
      { 5.05e+00,  1.125e+00,  1.064e+00, -2.190e+01 },
      { 5.10e+00,  1.127e+00,  1.064e+00, -2.191e+01 },
      { 5.15e+00,  1.128e+00,  1.064e+00, -2.190e+01 },
      { 5.20e+00,  1.128e+00,  1.064e+00, -2.188e+01 },
      { 5.25e+00,  1.128e+00,  1.064e+00, -2.186e+01 },
      { 5.30e+00,  1.128e+00,  1.064e+00, -2.185e+01 },
      { 5.35e+00,  1.128e+00,  1.064e+00, -2.184e+01 },
      { 5.40e+00,  1.128e+00,  1.064e+00, -2.187e+01 },
      { 5.45e+00,  1.128e+00,  1.064e+00, -2.200e+01 },
      { 5.50e+00,  1.129e+00,  1.064e+00, -2.221e+01 },
      { 5.55e+00,  1.129e+00,  1.064e+00, -2.239e+01 },
      { 5.60e+00,  1.129e+00,  1.064e+00, -2.249e+01 },
      { 5.65e+00,  1.129e+00,  1.064e+00, -2.254e+01 },
      { 5.70e+00,  1.129e+00,  1.064e+00, -2.255e+01 },
      { 5.75e+00,  1.129e+00,  1.064e+00, -2.256e+01 },
      { 5.80e+00,  1.129e+00,  1.064e+00, -2.262e+01 },
      { 5.85e+00,  1.129e+00,  1.064e+00, -2.273e+01 },
      { 5.90e+00,  1.129e+00,  1.064e+00, -2.282e+01 },
      { 5.95e+00,  1.129e+00,  1.064e+00, -2.286e+01 },
      { 6.00e+00,  1.129e+00,  1.064e+00, -2.289e+01 },
      { 6.05e+00,  1.129e+00,  1.064e+00, -2.292e+01 },
      { 6.10e+00,  1.129e+00,  1.064e+00, -2.293e+01 },
      { 6.15e+00,  1.129e+00,  1.064e+00, -2.293e+01 },
      { 6.20e+00,  1.129e+00,  1.064e+00, -2.292e+01 },
      { 6.25e+00,  1.129e+00,  1.064e+00, -2.293e+01 },
      { 6.30e+00,  1.129e+00,  1.064e+00, -2.297e+01 },
      { 6.35e+00,  1.129e+00,  1.064e+00, -2.301e+01 },
      { 6.40e+00,  1.129e+00,  1.064e+00, -2.304e+01 },
      { 6.45e+00,  1.129e+00,  1.064e+00, -2.306e+01 },
      { 6.50e+00,  1.129e+00,  1.064e+00, -2.307e+01 },
      { 6.55e+00,  1.129e+00,  1.064e+00, -2.307e+01 },
      { 6.60e+00,  1.129e+00,  1.064e+00, -2.307e+01 },
      { 6.65e+00,  1.129e+00,  1.064e+00, -2.307e+01 },
      { 6.70e+00,  1.129e+00,  1.064e+00, -2.307e+01 },
      { 6.75e+00,  1.129e+00,  1.064e+00, -2.306e+01 },
      { 6.80e+00,  1.129e+00,  1.064e+00, -2.305e+01 },
      { 6.85e+00,  1.129e+00,  1.064e+00, -2.304e+01 },
      { 6.90e+00,  1.129e+00,  1.064e+00, -2.302e+01 },
      { 6.95e+00,  1.129e+00,  1.064e+00, -2.301e+01 },
      { 7.00e+00,  1.129e+00,  1.064e+00, -2.300e+01 },
      { 7.05e+00,  1.129e+00,  1.064e+00, -2.298e+01 },
      { 7.10e+00,  1.129e+00,  1.064e+00, -2.297e+01 },
      { 7.15e+00,  1.129e+00,  1.064e+00, -2.296e+01 },
      { 7.20e+00,  1.129e+00,  1.064e+00, -2.294e+01 },
      { 7.25e+00,  1.129e+00,  1.064e+00, -2.293e+01 },
      { 7.30e+00,  1.129e+00,  1.064e+00, -2.291e+01 },
      { 7.35e+00,  1.129e+00,  1.064e+00, -2.289e+01 },
      { 7.40e+00,  1.129e+00,  1.064e+00, -2.287e+01 },
      { 7.45e+00,  1.129e+00,  1.064e+00, -2.285e+01 },
      { 7.50e+00,  1.129e+00,  1.064e+00, -2.283e+01 },
      { 7.55e+00,  1.129e+00,  1.064e+00, -2.281e+01 },
      { 7.60e+00,  1.129e+00,  1.064e+00, -2.279e+01 },
      { 7.65e+00,  1.129e+00,  1.064e+00, -2.277e+01 },
      { 7.70e+00,  1.129e+00,  1.064e+00, -2.275e+01 },
      { 7.75e+00,  1.129e+00,  1.064e+00, -2.273e+01 },
      { 7.80e+00,  1.129e+00,  1.064e+00, -2.270e+01 },
      { 7.85e+00,  1.129e+00,  1.064e+00, -2.268e+01 },
      { 7.90e+00,  1.129e+00,  1.064e+00, -2.266e+01 },
      { 7.95e+00,  1.129e+00,  1.064e+00, -2.264e+01 },
      { 8.00e+00,  1.129e+00,  1.064e+00, -2.262e+01 },
      { 8.05e+00,  1.129e+00,  1.064e+00, -2.259e+01 },
      { 8.10e+00,  1.129e+00,  1.064e+00, -2.257e+01 },
      { 8.15e+00,  1.129e+00,  1.064e+00, -2.255e+01 },
      { 8.20e+00,  1.129e+00,  1.064e+00, -2.253e+01 },
      { 8.25e+00,  1.129e+00,  1.064e+00, -2.250e+01 },
      { 8.30e+00,  1.129e+00,  1.064e+00, -2.248e+01 },
      { 8.35e+00,  1.129e+00,  1.064e+00, -2.246e+01 },
      { 8.40e+00,  1.129e+00,  1.064e+00, -2.244e+01 },
      { 8.45e+00,  1.129e+00,  1.064e+00, -2.241e+01 }
    },
    // m-10.cie
    {
      { 4.00e+00,  2.000e-03,  1.064e+00, -2.594e+01 },
      { 4.05e+00,  1.400e-02,  1.064e+00, -2.461e+01 },
      { 4.10e+00,  7.000e-02,  1.064e+00, -2.349e+01 },
      { 4.15e+00,  2.530e-01,  1.064e+00, -2.260e+01 },
      { 4.20e+00,  5.670e-01,  1.064e+00, -2.210e+01 },
      { 4.25e+00,  8.160e-01,  1.064e+00, -2.195e+01 },
      { 4.30e+00,  9.310e-01,  1.064e+00, -2.199e+01 },
      { 4.35e+00,  9.760e-01,  1.064e+00, -2.207e+01 },
      { 4.40e+00,  9.980e-01,  1.064e+00, -2.213e+01 },
      { 4.45e+00,  1.021e+00,  1.064e+00, -2.215e+01 },
      { 4.50e+00,  1.043e+00,  1.064e+00, -2.215e+01 },
      { 4.55e+00,  1.055e+00,  1.064e+00, -2.211e+01 },
      { 4.60e+00,  1.061e+00,  1.064e+00, -2.206e+01 },
      { 4.65e+00,  1.063e+00,  1.064e+00, -2.198e+01 },
      { 4.70e+00,  1.064e+00,  1.064e+00, -2.190e+01 },
      { 4.75e+00,  1.066e+00,  1.064e+00, -2.181e+01 },
      { 4.80e+00,  1.071e+00,  1.064e+00, -2.172e+01 },
      { 4.85e+00,  1.082e+00,  1.064e+00, -2.163e+01 },
      { 4.90e+00,  1.099e+00,  1.064e+00, -2.157e+01 },
      { 4.95e+00,  1.114e+00,  1.064e+00, -2.154e+01 },
      { 5.00e+00,  1.122e+00,  1.064e+00, -2.153e+01 },
      { 5.05e+00,  1.126e+00,  1.064e+00, -2.152e+01 },
      { 5.10e+00,  1.127e+00,  1.064e+00, -2.150e+01 },
      { 5.15e+00,  1.128e+00,  1.064e+00, -2.147e+01 },
      { 5.20e+00,  1.129e+00,  1.064e+00, -2.144e+01 },
      { 5.25e+00,  1.129e+00,  1.064e+00, -2.141e+01 },
      { 5.30e+00,  1.129e+00,  1.064e+00, -2.138e+01 },
      { 5.35e+00,  1.129e+00,  1.064e+00, -2.136e+01 },
      { 5.40e+00,  1.129e+00,  1.064e+00, -2.140e+01 },
      { 5.45e+00,  1.130e+00,  1.064e+00, -2.153e+01 },
      { 5.50e+00,  1.130e+00,  1.064e+00, -2.175e+01 },
      { 5.55e+00,  1.130e+00,  1.064e+00, -2.195e+01 },
      { 5.60e+00,  1.130e+00,  1.064e+00, -2.207e+01 },
      { 5.65e+00,  1.130e+00,  1.064e+00, -2.211e+01 },
      { 5.70e+00,  1.130e+00,  1.064e+00, -2.212e+01 },
      { 5.75e+00,  1.130e+00,  1.064e+00, -2.214e+01 },
      { 5.80e+00,  1.130e+00,  1.064e+00, -2.220e+01 },
      { 5.85e+00,  1.130e+00,  1.064e+00, -2.233e+01 },
      { 5.90e+00,  1.130e+00,  1.064e+00, -2.245e+01 },
      { 5.95e+00,  1.130e+00,  1.064e+00, -2.251e+01 },
      { 6.00e+00,  1.130e+00,  1.064e+00, -2.255e+01 },
      { 6.05e+00,  1.130e+00,  1.064e+00, -2.258e+01 },
      { 6.10e+00,  1.131e+00,  1.064e+00, -2.260e+01 },
      { 6.15e+00,  1.131e+00,  1.064e+00, -2.259e+01 },
      { 6.20e+00,  1.131e+00,  1.064e+00, -2.259e+01 },
      { 6.25e+00,  1.131e+00,  1.064e+00, -2.261e+01 },
      { 6.30e+00,  1.131e+00,  1.064e+00, -2.267e+01 },
      { 6.35e+00,  1.131e+00,  1.064e+00, -2.274e+01 },
      { 6.40e+00,  1.131e+00,  1.064e+00, -2.280e+01 },
      { 6.45e+00,  1.131e+00,  1.064e+00, -2.284e+01 },
      { 6.50e+00,  1.131e+00,  1.064e+00, -2.287e+01 },
      { 6.55e+00,  1.131e+00,  1.064e+00, -2.289e+01 },
      { 6.60e+00,  1.131e+00,  1.064e+00, -2.291e+01 },
      { 6.65e+00,  1.131e+00,  1.064e+00, -2.292e+01 },
      { 6.70e+00,  1.131e+00,  1.064e+00, -2.293e+01 },
      { 6.75e+00,  1.131e+00,  1.064e+00, -2.294e+01 },
      { 6.80e+00,  1.131e+00,  1.064e+00, -2.294e+01 },
      { 6.85e+00,  1.131e+00,  1.064e+00, -2.294e+01 },
      { 6.90e+00,  1.131e+00,  1.064e+00, -2.293e+01 },
      { 6.95e+00,  1.131e+00,  1.064e+00, -2.292e+01 },
      { 7.00e+00,  1.131e+00,  1.064e+00, -2.291e+01 },
      { 7.05e+00,  1.131e+00,  1.064e+00, -2.290e+01 },
      { 7.10e+00,  1.131e+00,  1.064e+00, -2.290e+01 },
      { 7.15e+00,  1.131e+00,  1.064e+00, -2.290e+01 },
      { 7.20e+00,  1.131e+00,  1.064e+00, -2.289e+01 },
      { 7.25e+00,  1.131e+00,  1.064e+00, -2.288e+01 },
      { 7.30e+00,  1.131e+00,  1.064e+00, -2.287e+01 },
      { 7.35e+00,  1.131e+00,  1.064e+00, -2.285e+01 },
      { 7.40e+00,  1.131e+00,  1.064e+00, -2.284e+01 },
      { 7.45e+00,  1.131e+00,  1.064e+00, -2.282e+01 },
      { 7.50e+00,  1.131e+00,  1.064e+00, -2.281e+01 },
      { 7.55e+00,  1.131e+00,  1.064e+00, -2.279e+01 },
      { 7.60e+00,  1.131e+00,  1.064e+00, -2.277e+01 },
      { 7.65e+00,  1.131e+00,  1.064e+00, -2.275e+01 },
      { 7.70e+00,  1.131e+00,  1.064e+00, -2.273e+01 },
      { 7.75e+00,  1.131e+00,  1.064e+00, -2.271e+01 },
      { 7.80e+00,  1.131e+00,  1.064e+00, -2.269e+01 },
      { 7.85e+00,  1.131e+00,  1.064e+00, -2.267e+01 },
      { 7.90e+00,  1.131e+00,  1.064e+00, -2.265e+01 },
      { 7.95e+00,  1.131e+00,  1.064e+00, -2.262e+01 },
      { 8.00e+00,  1.131e+00,  1.064e+00, -2.260e+01 },
      { 8.05e+00,  1.131e+00,  1.064e+00, -2.258e+01 },
      { 8.10e+00,  1.131e+00,  1.064e+00, -2.256e+01 },
      { 8.15e+00,  1.131e+00,  1.064e+00, -2.254e+01 },
      { 8.20e+00,  1.131e+00,  1.064e+00, -2.251e+01 },
      { 8.25e+00,  1.131e+00,  1.064e+00, -2.249e+01 },
      { 8.30e+00,  1.131e+00,  1.064e+00, -2.247e+01 },
      { 8.35e+00,  1.131e+00,  1.064e+00, -2.245e+01 },
      { 8.40e+00,  1.131e+00,  1.064e+00, -2.242e+01 },
      { 8.45e+00,  1.131e+00,  1.064e+00, -2.240e+01 }
    },
    // m-05.cie
    {
      { 4.00e+00,  2.000e-03,  1.080e+00, -2.583e+01 },
      { 4.05e+00,  1.400e-02,  1.080e+00, -2.449e+01 },
      { 4.10e+00,  7.000e-02,  1.080e+00, -2.342e+01 },
      { 4.15e+00,  2.530e-01,  1.080e+00, -2.256e+01 },
      { 4.20e+00,  5.670e-01,  1.080e+00, -2.207e+01 },
      { 4.25e+00,  8.160e-01,  1.080e+00, -2.192e+01 },
      { 4.30e+00,  9.320e-01,  1.080e+00, -2.194e+01 },
      { 4.35e+00,  9.770e-01,  1.080e+00, -2.200e+01 },
      { 4.40e+00,  1.001e+00,  1.080e+00, -2.202e+01 },
      { 4.45e+00,  1.027e+00,  1.080e+00, -2.200e+01 },
      { 4.50e+00,  1.054e+00,  1.080e+00, -2.194e+01 },
      { 4.55e+00,  1.069e+00,  1.080e+00, -2.187e+01 },
      { 4.60e+00,  1.076e+00,  1.080e+00, -2.178e+01 },
      { 4.65e+00,  1.079e+00,  1.080e+00, -2.169e+01 },
      { 4.70e+00,  1.080e+00,  1.080e+00, -2.159e+01 },
      { 4.75e+00,  1.082e+00,  1.080e+00, -2.150e+01 },
      { 4.80e+00,  1.088e+00,  1.080e+00, -2.141e+01 },
      { 4.85e+00,  1.103e+00,  1.080e+00, -2.133e+01 },
      { 4.90e+00,  1.124e+00,  1.080e+00, -2.127e+01 },
      { 4.95e+00,  1.142e+00,  1.080e+00, -2.123e+01 },
      { 5.00e+00,  1.152e+00,  1.080e+00, -2.122e+01 },
      { 5.05e+00,  1.157e+00,  1.080e+00, -2.123e+01 },
      { 5.10e+00,  1.159e+00,  1.080e+00, -2.122e+01 },
      { 5.15e+00,  1.160e+00,  1.080e+00, -2.119e+01 },
      { 5.20e+00,  1.161e+00,  1.080e+00, -2.116e+01 },
      { 5.25e+00,  1.161e+00,  1.080e+00, -2.114e+01 },
      { 5.30e+00,  1.161e+00,  1.080e+00, -2.112e+01 },
      { 5.35e+00,  1.162e+00,  1.080e+00, -2.110e+01 },
      { 5.40e+00,  1.162e+00,  1.080e+00, -2.114e+01 },
      { 5.45e+00,  1.162e+00,  1.080e+00, -2.127e+01 },
      { 5.50e+00,  1.163e+00,  1.080e+00, -2.150e+01 },
      { 5.55e+00,  1.163e+00,  1.080e+00, -2.170e+01 },
      { 5.60e+00,  1.163e+00,  1.080e+00, -2.181e+01 },
      { 5.65e+00,  1.163e+00,  1.080e+00, -2.185e+01 },
      { 5.70e+00,  1.163e+00,  1.080e+00, -2.186e+01 },
      { 5.75e+00,  1.163e+00,  1.080e+00, -2.187e+01 },
      { 5.80e+00,  1.163e+00,  1.080e+00, -2.193e+01 },
      { 5.85e+00,  1.163e+00,  1.080e+00, -2.205e+01 },
      { 5.90e+00,  1.163e+00,  1.080e+00, -2.215e+01 },
      { 5.95e+00,  1.164e+00,  1.080e+00, -2.219e+01 },
      { 6.00e+00,  1.164e+00,  1.080e+00, -2.222e+01 },
      { 6.05e+00,  1.164e+00,  1.080e+00, -2.224e+01 },
      { 6.10e+00,  1.164e+00,  1.080e+00, -2.224e+01 },
      { 6.15e+00,  1.164e+00,  1.080e+00, -2.224e+01 },
      { 6.20e+00,  1.164e+00,  1.080e+00, -2.223e+01 },
      { 6.25e+00,  1.164e+00,  1.080e+00, -2.226e+01 },
      { 6.30e+00,  1.164e+00,  1.080e+00, -2.234e+01 },
      { 6.35e+00,  1.164e+00,  1.080e+00, -2.244e+01 },
      { 6.40e+00,  1.164e+00,  1.080e+00, -2.253e+01 },
      { 6.45e+00,  1.165e+00,  1.080e+00, -2.259e+01 },
      { 6.50e+00,  1.165e+00,  1.080e+00, -2.264e+01 },
      { 6.55e+00,  1.165e+00,  1.080e+00, -2.266e+01 },
      { 6.60e+00,  1.165e+00,  1.080e+00, -2.269e+01 },
      { 6.65e+00,  1.165e+00,  1.080e+00, -2.271e+01 },
      { 6.70e+00,  1.165e+00,  1.080e+00, -2.273e+01 },
      { 6.75e+00,  1.165e+00,  1.080e+00, -2.275e+01 },
      { 6.80e+00,  1.165e+00,  1.080e+00, -2.276e+01 },
      { 6.85e+00,  1.165e+00,  1.080e+00, -2.275e+01 },
      { 6.90e+00,  1.165e+00,  1.080e+00, -2.274e+01 },
      { 6.95e+00,  1.165e+00,  1.080e+00, -2.274e+01 },
      { 7.00e+00,  1.165e+00,  1.080e+00, -2.273e+01 },
      { 7.05e+00,  1.165e+00,  1.080e+00, -2.273e+01 },
      { 7.10e+00,  1.165e+00,  1.080e+00, -2.275e+01 },
      { 7.15e+00,  1.165e+00,  1.080e+00, -2.276e+01 },
      { 7.20e+00,  1.165e+00,  1.080e+00, -2.277e+01 },
      { 7.25e+00,  1.165e+00,  1.080e+00, -2.277e+01 },
      { 7.30e+00,  1.165e+00,  1.080e+00, -2.277e+01 },
      { 7.35e+00,  1.165e+00,  1.080e+00, -2.276e+01 },
      { 7.40e+00,  1.165e+00,  1.080e+00, -2.275e+01 },
      { 7.45e+00,  1.165e+00,  1.080e+00, -2.274e+01 },
      { 7.50e+00,  1.165e+00,  1.080e+00, -2.273e+01 },
      { 7.55e+00,  1.165e+00,  1.080e+00, -2.272e+01 },
      { 7.60e+00,  1.165e+00,  1.080e+00, -2.270e+01 },
      { 7.65e+00,  1.165e+00,  1.080e+00, -2.268e+01 },
      { 7.70e+00,  1.165e+00,  1.080e+00, -2.266e+01 },
      { 7.75e+00,  1.165e+00,  1.080e+00, -2.265e+01 },
      { 7.80e+00,  1.165e+00,  1.080e+00, -2.263e+01 },
      { 7.85e+00,  1.165e+00,  1.080e+00, -2.261e+01 },
      { 7.90e+00,  1.165e+00,  1.080e+00, -2.259e+01 },
      { 7.95e+00,  1.165e+00,  1.080e+00, -2.257e+01 },
      { 8.00e+00,  1.165e+00,  1.080e+00, -2.255e+01 },
      { 8.05e+00,  1.165e+00,  1.080e+00, -2.253e+01 },
      { 8.10e+00,  1.165e+00,  1.080e+00, -2.250e+01 },
      { 8.15e+00,  1.165e+00,  1.080e+00, -2.248e+01 },
      { 8.20e+00,  1.165e+00,  1.080e+00, -2.246e+01 },
      { 8.25e+00,  1.165e+00,  1.080e+00, -2.244e+01 },
      { 8.30e+00,  1.165e+00,  1.080e+00, -2.242e+01 },
      { 8.35e+00,  1.165e+00,  1.080e+00, -2.240e+01 },
      { 8.40e+00,  1.165e+00,  1.080e+00, -2.238e+01 },
      { 8.45e+00,  1.165e+00,  1.080e+00, -2.235e+01 }
    },
    // m-00.cie
    {
      { 4.00e+00,  2.000e-03,  1.099e+00, -2.565e+01 },
      { 4.05e+00,  1.400e-02,  1.099e+00, -2.427e+01 },
      { 4.10e+00,  7.000e-02,  1.099e+00, -2.328e+01 },
      { 4.15e+00,  2.530e-01,  1.099e+00, -2.247e+01 },
      { 4.20e+00,  5.680e-01,  1.099e+00, -2.199e+01 },
      { 4.25e+00,  8.180e-01,  1.099e+00, -2.184e+01 },
      { 4.30e+00,  9.320e-01,  1.099e+00, -2.185e+01 },
      { 4.35e+00,  9.780e-01,  1.099e+00, -2.187e+01 },
      { 4.40e+00,  1.004e+00,  1.099e+00, -2.184e+01 },
      { 4.45e+00,  1.035e+00,  1.099e+00, -2.177e+01 },
      { 4.50e+00,  1.067e+00,  1.099e+00, -2.166e+01 },
      { 4.55e+00,  1.086e+00,  1.099e+00, -2.156e+01 },
      { 4.60e+00,  1.094e+00,  1.099e+00, -2.145e+01 },
      { 4.65e+00,  1.098e+00,  1.099e+00, -2.134e+01 },
      { 4.70e+00,  1.100e+00,  1.099e+00, -2.124e+01 },
      { 4.75e+00,  1.102e+00,  1.099e+00, -2.114e+01 },
      { 4.80e+00,  1.110e+00,  1.099e+00, -2.105e+01 },
      { 4.85e+00,  1.128e+00,  1.099e+00, -2.097e+01 },
      { 4.90e+00,  1.154e+00,  1.099e+00, -2.091e+01 },
      { 4.95e+00,  1.176e+00,  1.099e+00, -2.087e+01 },
      { 5.00e+00,  1.188e+00,  1.099e+00, -2.087e+01 },
      { 5.05e+00,  1.195e+00,  1.099e+00, -2.090e+01 },
      { 5.10e+00,  1.198e+00,  1.099e+00, -2.091e+01 },
      { 5.15e+00,  1.199e+00,  1.099e+00, -2.089e+01 },
      { 5.20e+00,  1.200e+00,  1.099e+00, -2.086e+01 },
      { 5.25e+00,  1.201e+00,  1.099e+00, -2.085e+01 },
      { 5.30e+00,  1.201e+00,  1.099e+00, -2.084e+01 },
      { 5.35e+00,  1.201e+00,  1.099e+00, -2.084e+01 },
      { 5.40e+00,  1.202e+00,  1.099e+00, -2.087e+01 },
      { 5.45e+00,  1.203e+00,  1.099e+00, -2.101e+01 },
      { 5.50e+00,  1.203e+00,  1.099e+00, -2.123e+01 },
      { 5.55e+00,  1.204e+00,  1.099e+00, -2.143e+01 },
      { 5.60e+00,  1.204e+00,  1.099e+00, -2.154e+01 },
      { 5.65e+00,  1.204e+00,  1.099e+00, -2.158e+01 },
      { 5.70e+00,  1.204e+00,  1.099e+00, -2.159e+01 },
      { 5.75e+00,  1.204e+00,  1.099e+00, -2.159e+01 },
      { 5.80e+00,  1.204e+00,  1.099e+00, -2.164e+01 },
      { 5.85e+00,  1.205e+00,  1.099e+00, -2.174e+01 },
      { 5.90e+00,  1.205e+00,  1.099e+00, -2.181e+01 },
      { 5.95e+00,  1.205e+00,  1.099e+00, -2.183e+01 },
      { 6.00e+00,  1.205e+00,  1.099e+00, -2.184e+01 },
      { 6.05e+00,  1.205e+00,  1.099e+00, -2.184e+01 },
      { 6.10e+00,  1.206e+00,  1.099e+00, -2.183e+01 },
      { 6.15e+00,  1.206e+00,  1.099e+00, -2.182e+01 },
      { 6.20e+00,  1.206e+00,  1.099e+00, -2.182e+01 },
      { 6.25e+00,  1.206e+00,  1.099e+00, -2.185e+01 },
      { 6.30e+00,  1.207e+00,  1.099e+00, -2.195e+01 },
      { 6.35e+00,  1.207e+00,  1.099e+00, -2.208e+01 },
      { 6.40e+00,  1.207e+00,  1.099e+00, -2.219e+01 },
      { 6.45e+00,  1.208e+00,  1.099e+00, -2.227e+01 },
      { 6.50e+00,  1.208e+00,  1.099e+00, -2.232e+01 },
      { 6.55e+00,  1.208e+00,  1.099e+00, -2.235e+01 },
      { 6.60e+00,  1.208e+00,  1.099e+00, -2.238e+01 },
      { 6.65e+00,  1.208e+00,  1.099e+00, -2.241e+01 },
      { 6.70e+00,  1.208e+00,  1.099e+00, -2.244e+01 },
      { 6.75e+00,  1.208e+00,  1.099e+00, -2.246e+01 },
      { 6.80e+00,  1.208e+00,  1.099e+00, -2.248e+01 },
      { 6.85e+00,  1.209e+00,  1.099e+00, -2.248e+01 },
      { 6.90e+00,  1.209e+00,  1.099e+00, -2.246e+01 },
      { 6.95e+00,  1.209e+00,  1.099e+00, -2.245e+01 },
      { 7.00e+00,  1.209e+00,  1.099e+00, -2.245e+01 },
      { 7.05e+00,  1.209e+00,  1.099e+00, -2.246e+01 },
      { 7.10e+00,  1.209e+00,  1.099e+00, -2.249e+01 },
      { 7.15e+00,  1.209e+00,  1.099e+00, -2.253e+01 },
      { 7.20e+00,  1.209e+00,  1.099e+00, -2.256e+01 },
      { 7.25e+00,  1.209e+00,  1.099e+00, -2.258e+01 },
      { 7.30e+00,  1.209e+00,  1.099e+00, -2.260e+01 },
      { 7.35e+00,  1.209e+00,  1.099e+00, -2.261e+01 },
      { 7.40e+00,  1.209e+00,  1.099e+00, -2.261e+01 },
      { 7.45e+00,  1.209e+00,  1.099e+00, -2.261e+01 },
      { 7.50e+00,  1.209e+00,  1.099e+00, -2.260e+01 },
      { 7.55e+00,  1.209e+00,  1.099e+00, -2.260e+01 },
      { 7.60e+00,  1.209e+00,  1.099e+00, -2.259e+01 },
      { 7.65e+00,  1.209e+00,  1.099e+00, -2.257e+01 },
      { 7.70e+00,  1.209e+00,  1.099e+00, -2.256e+01 },
      { 7.75e+00,  1.209e+00,  1.099e+00, -2.254e+01 },
      { 7.80e+00,  1.209e+00,  1.099e+00, -2.253e+01 },
      { 7.85e+00,  1.209e+00,  1.099e+00, -2.251e+01 },
      { 7.90e+00,  1.209e+00,  1.099e+00, -2.249e+01 },
      { 7.95e+00,  1.209e+00,  1.099e+00, -2.248e+01 },
      { 8.00e+00,  1.209e+00,  1.099e+00, -2.246e+01 },
      { 8.05e+00,  1.209e+00,  1.099e+00, -2.244e+01 },
      { 8.10e+00,  1.209e+00,  1.099e+00, -2.242e+01 },
      { 8.15e+00,  1.209e+00,  1.099e+00, -2.240e+01 },
      { 8.20e+00,  1.209e+00,  1.099e+00, -2.238e+01 },
      { 8.25e+00,  1.209e+00,  1.099e+00, -2.236e+01 },
      { 8.30e+00,  1.209e+00,  1.099e+00, -2.234e+01 },
      { 8.35e+00,  1.209e+00,  1.099e+00, -2.232e+01 },
      { 8.40e+00,  1.209e+00,  1.099e+00, -2.230e+01 },
      { 8.45e+00,  1.209e+00,  1.099e+00, -2.228e+01 }
    },
    // m+05.cie
    {
      { 4.10e+00,  7.100e-02,  1.103e+00, -2.298e+01 },
      { 4.10e+00,  7.100e-02,  1.103e+00, -2.298e+01 },
      { 4.15e+00,  2.550e-01,  1.103e+00, -2.226e+01 },
      { 4.20e+00,  5.700e-01,  1.103e+00, -2.180e+01 },
      { 4.25e+00,  8.200e-01,  1.103e+00, -2.164e+01 },
      { 4.30e+00,  9.360e-01,  1.103e+00, -2.161e+01 },
      { 4.35e+00,  9.810e-01,  1.103e+00, -2.157e+01 },
      { 4.40e+00,  1.008e+00,  1.103e+00, -2.148e+01 },
      { 4.45e+00,  1.039e+00,  1.103e+00, -2.136e+01 },
      { 4.50e+00,  1.071e+00,  1.103e+00, -2.122e+01 },
      { 4.55e+00,  1.090e+00,  1.103e+00, -2.109e+01 },
      { 4.60e+00,  1.098e+00,  1.103e+00, -2.097e+01 },
      { 4.65e+00,  1.102e+00,  1.103e+00, -2.086e+01 },
      { 4.70e+00,  1.104e+00,  1.103e+00, -2.075e+01 },
      { 4.75e+00,  1.107e+00,  1.103e+00, -2.065e+01 },
      { 4.80e+00,  1.116e+00,  1.103e+00, -2.057e+01 },
      { 4.85e+00,  1.134e+00,  1.103e+00, -2.050e+01 },
      { 4.90e+00,  1.160e+00,  1.103e+00, -2.043e+01 },
      { 4.95e+00,  1.183e+00,  1.103e+00, -2.039e+01 },
      { 5.00e+00,  1.197e+00,  1.103e+00, -2.039e+01 },
      { 5.05e+00,  1.204e+00,  1.103e+00, -2.042e+01 },
      { 5.10e+00,  1.208e+00,  1.103e+00, -2.042e+01 },
      { 5.15e+00,  1.210e+00,  1.103e+00, -2.040e+01 },
      { 5.20e+00,  1.211e+00,  1.103e+00, -2.037e+01 },
      { 5.25e+00,  1.212e+00,  1.103e+00, -2.035e+01 },
      { 5.30e+00,  1.213e+00,  1.103e+00, -2.034e+01 },
      { 5.35e+00,  1.215e+00,  1.103e+00, -2.034e+01 },
      { 5.40e+00,  1.216e+00,  1.103e+00, -2.037e+01 },
      { 5.45e+00,  1.219e+00,  1.103e+00, -2.051e+01 },
      { 5.50e+00,  1.221e+00,  1.103e+00, -2.073e+01 },
      { 5.55e+00,  1.221e+00,  1.103e+00, -2.093e+01 },
      { 5.60e+00,  1.222e+00,  1.103e+00, -2.105e+01 },
      { 5.65e+00,  1.222e+00,  1.103e+00, -2.109e+01 },
      { 5.70e+00,  1.223e+00,  1.103e+00, -2.109e+01 },
      { 5.75e+00,  1.223e+00,  1.103e+00, -2.109e+01 },
      { 5.80e+00,  1.224e+00,  1.103e+00, -2.114e+01 },
      { 5.85e+00,  1.224e+00,  1.103e+00, -2.124e+01 },
      { 5.90e+00,  1.225e+00,  1.103e+00, -2.132e+01 },
      { 5.95e+00,  1.226e+00,  1.103e+00, -2.134e+01 },
      { 6.00e+00,  1.226e+00,  1.103e+00, -2.135e+01 },
      { 6.05e+00,  1.227e+00,  1.103e+00, -2.135e+01 },
      { 6.10e+00,  1.227e+00,  1.103e+00, -2.134e+01 },
      { 6.15e+00,  1.228e+00,  1.103e+00, -2.133e+01 },
      { 6.20e+00,  1.229e+00,  1.103e+00, -2.132e+01 },
      { 6.25e+00,  1.230e+00,  1.103e+00, -2.135e+01 },
      { 6.30e+00,  1.231e+00,  1.103e+00, -2.146e+01 },
      { 6.35e+00,  1.232e+00,  1.103e+00, -2.159e+01 },
      { 6.40e+00,  1.233e+00,  1.103e+00, -2.171e+01 },
      { 6.45e+00,  1.234e+00,  1.103e+00, -2.180e+01 },
      { 6.50e+00,  1.234e+00,  1.103e+00, -2.186e+01 },
      { 6.55e+00,  1.235e+00,  1.103e+00, -2.190e+01 },
      { 6.60e+00,  1.235e+00,  1.103e+00, -2.193e+01 },
      { 6.65e+00,  1.236e+00,  1.103e+00, -2.196e+01 },
      { 6.70e+00,  1.236e+00,  1.103e+00, -2.200e+01 },
      { 6.75e+00,  1.236e+00,  1.103e+00, -2.204e+01 },
      { 6.80e+00,  1.237e+00,  1.103e+00, -2.206e+01 },
      { 6.85e+00,  1.237e+00,  1.103e+00, -2.206e+01 },
      { 6.90e+00,  1.237e+00,  1.103e+00, -2.205e+01 },
      { 6.95e+00,  1.237e+00,  1.103e+00, -2.204e+01 },
      { 7.00e+00,  1.237e+00,  1.103e+00, -2.204e+01 },
      { 7.05e+00,  1.237e+00,  1.103e+00, -2.206e+01 },
      { 7.10e+00,  1.238e+00,  1.103e+00, -2.211e+01 },
      { 7.15e+00,  1.238e+00,  1.103e+00, -2.216e+01 },
      { 7.20e+00,  1.238e+00,  1.103e+00, -2.221e+01 },
      { 7.25e+00,  1.238e+00,  1.103e+00, -2.226e+01 },
      { 7.30e+00,  1.238e+00,  1.103e+00, -2.230e+01 },
      { 7.35e+00,  1.238e+00,  1.103e+00, -2.232e+01 },
      { 7.40e+00,  1.238e+00,  1.103e+00, -2.235e+01 },
      { 7.45e+00,  1.238e+00,  1.103e+00, -2.236e+01 },
      { 7.50e+00,  1.238e+00,  1.103e+00, -2.237e+01 },
      { 7.55e+00,  1.238e+00,  1.103e+00, -2.237e+01 },
      { 7.60e+00,  1.238e+00,  1.103e+00, -2.237e+01 },
      { 7.65e+00,  1.238e+00,  1.103e+00, -2.237e+01 },
      { 7.70e+00,  1.238e+00,  1.103e+00, -2.237e+01 },
      { 7.75e+00,  1.238e+00,  1.103e+00, -2.236e+01 },
      { 7.80e+00,  1.238e+00,  1.103e+00, -2.235e+01 },
      { 7.85e+00,  1.238e+00,  1.103e+00, -2.234e+01 },
      { 7.90e+00,  1.238e+00,  1.103e+00, -2.233e+01 },
      { 7.95e+00,  1.238e+00,  1.103e+00, -2.231e+01 },
      { 8.00e+00,  1.238e+00,  1.103e+00, -2.230e+01 },
      { 8.05e+00,  1.238e+00,  1.103e+00, -2.229e+01 },
      { 8.10e+00,  1.238e+00,  1.103e+00, -2.227e+01 },
      { 8.15e+00,  1.238e+00,  1.103e+00, -2.226e+01 },
      { 8.20e+00,  1.238e+00,  1.103e+00, -2.225e+01 },
      { 8.25e+00,  1.238e+00,  1.103e+00, -2.223e+01 },
      { 8.30e+00,  1.238e+00,  1.103e+00, -2.221e+01 },
      { 8.35e+00,  1.239e+00,  1.103e+00, -2.220e+01 },
      { 8.40e+00,  1.239e+00,  1.103e+00, -2.218e+01 },
      { 8.45e+00,  1.239e+00,  1.103e+00, -2.216e+01 },
      { 8.50e+00,  1.239e+00,  1.103e+00, -2.214e+01 }
    }
  };
  
  // read in Sutherland & Dopita Cooling Tables
  struct SutherlandDopita
  {
    // constructor
    SutherlandDopita() //const string a_file_path)
    {
      // timer
      Timer_t<> t("SutherlandDopita::SutherlandDopita");

      // specifics of SD table
      m_logT_min=4.0;
      m_logT_max=8.450;
      m_d_logT  =5.e-2;
      
      // resize cooling and other tables
      m_met_tab.resize(s_num_metal_bins);
      m_ne_tab .resize(s_num_metal_bins);
      m_nt_tab .resize(s_num_metal_bins);
      m_lambda_tab.resize(s_num_metal_bins);

      {
        Timer_t<> t("SutherlandDopita::SutherlandDopita::build_table");

        for (int z=0; z<s_num_metal_bins; ++z)
          {
            m_met_tab[z]=std::pow(ten,s_log_met_tab[z]);
        
            //std::ifstream file( a_file_path+"/"+sd_file_names[z] );
            //if (!file) {std::cerr << "Error opening file !" << endl; exit(0);}
            // cooling table
            for (int t=0; t<s_num_temp_bins; ++t)
              {
                //double ne, nt, lambda, dummy;
                //file >> dummy >> ne >> dummy >> nt >> lambda;
                //file.ignore((std::streamsize)200,'\n');
                m_ne_tab[z]    .push_back( (double)s_cooling_met_cie_tab[z][t][1] );
                m_nt_tab[z]    .push_back( (double)s_cooling_met_cie_tab[z][t][2] );
                m_lambda_tab[z].push_back( (double)s_cooling_met_cie_tab[z][t][3] );
              }
            assert(m_lambda_tab[z].size()==s_num_temp_bins);
            //file.close();
          }
      }
    }
    
    // destructor
    ~SutherlandDopita() {}
    
    // cooling function as a function of temeperature and metallicity
    double lambda(const double a_T, const double a_Z) const
    {
      assert(a_Z>=zero && a_Z<=one);
      
      double lambda= std::pow(ten, interpolate_table(a_T,a_Z,m_lambda_tab) );
      return lambda;
    }
    
    double n_e(const double a_T, const double a_Z) const
    {
      //assert(a_Z>=zero && a_Z<=one);
      return (interpolate_table(a_T,a_Z,m_ne_tab));
    }
    
    double n_t(const double a_T, const double a_Z) const
    {
      assert(a_Z>=zero && a_Z<=one);
      return (interpolate_table(a_T,a_Z,m_nt_tab));
    }
    
    void cooling_cie_vars(double& a_ne, double& a_nt, double& a_lambda, const double a_T, const double a_Z) const
    {
      Timer_t<> t("SutherlandDopita::cooling_cie_vars");
      assert(a_Z>=zero && a_Z<=one);
      
      double ne=zero;
      double nt=zero;
      double lc=zero;
      
      // linear interpolation in log space
      const double logT=std::log10(a_T);
      if (logT>=m_logT_min && logT<=m_logT_max)
      {
        // find t-bin
        const int t= (int)floor((logT-m_logT_min)/m_d_logT);
        const int tp=std::min(t+1,s_num_temp_bins-1);
        
        // find z-bin and add z-interpolation
        int z,zp;
        if (a_Z<=m_met_tab[1])
        {
          // bin is trivial
          z=0;
          zp=1;
          // linear interpolation in linear space
          const double dZ= m_met_tab[zp]-m_met_tab[z];
          ne =(m_ne_tab[zp][t]-m_ne_tab[z][t])/dZ  *(a_Z-m_met_tab[z]);
          nt =(m_nt_tab[zp][t]-m_nt_tab[z][t])/dZ  *(a_Z-m_met_tab[z]);
          lc =(m_lambda_tab[zp][t]-m_lambda_tab[z][t])/dZ  *(a_Z-m_met_tab[z]);
        }
        else
        {
          // bin search
          zp=2;
          while (a_Z>m_met_tab[zp]) ++zp;
          z=zp-1;
          // linear interpolation in log space
          const double dlZ= std::log10(m_met_tab[zp] / m_met_tab[z]);
          ne =(m_ne_tab[zp][t]-m_ne_tab[z][t])/dlZ  *std::log10(a_Z/m_met_tab[z]);
          nt =(m_nt_tab[zp][t]-m_nt_tab[z][t])/dlZ  *std::log10(a_Z/m_met_tab[z]);
          lc =(m_lambda_tab[zp][t]-m_lambda_tab[z][t])/dlZ  *std::log10(a_Z/m_met_tab[z]);
        }
        
        // temperature interpolation
        ne += (m_ne_tab[z][tp]-m_ne_tab[z][t])/m_d_logT *(logT-(m_logT_min+t*m_d_logT));
        nt += (m_nt_tab[z][tp]-m_nt_tab[z][t])/m_d_logT *(logT-(m_logT_min+t*m_d_logT));
        lc += (m_lambda_tab[z][tp]-m_lambda_tab[z][t])/m_d_logT *(logT-(m_logT_min+t*m_d_logT));
        
        // main contribution
        ne += m_ne_tab[z][t];
        nt += m_nt_tab[z][t];
        lc += m_lambda_tab[z][t];
      }
      
      // set returned values
      a_ne=ne;
      a_nt=nt;
      a_lambda=std::pow(ten,lc);
    }
    
  protected:
    
    // cooling function as a function of temeperature and metallicity
    double interpolate_table(const double a_T,
                             const double a_Z,
                             const std::vector<std::vector<double> >& a_table) const
    {
      Timer_t<> t("SutherlandDopita::interpolate_table");
      assert(a_Z>=zero && a_Z<=one);
      
      double q=zero;
      
      // linear interpolation in log space
      int z,zp;
      const double logT=std::log10(a_T);
      if (logT>m_logT_min && logT<m_logT_max)
      {
        // find t-bin
        const int t= (int)floor((logT-m_logT_min)/m_d_logT);
        const int tp=std::min(t+1,s_num_temp_bins-1);

        // find z-bin and add z-interpolation
        if (a_Z<=m_met_tab[1])
        {
          // bin is trivial
          z=0;
          zp=1;
          // linear interpolation in linear space
          const double dZ= m_met_tab[zp]-m_met_tab[z];
          q =(a_table[zp][t]-a_table[z][t])/dZ  *(a_Z-m_met_tab[z]);
        }
        else
        {
          // bin search
          zp=2;
          while (a_Z>m_met_tab[zp]) ++zp;
          z=zp-1;

          // linear interpolation in log space
          const double dlZ= std::log10(m_met_tab[zp] / m_met_tab[z]);
          q =(a_table[zp][t]-a_table[z][t])/dlZ  *std::log10(a_Z/m_met_tab[z]);
        }
        // temperature interpolation
        q += (a_table[z][tp]-a_table[z][t])/m_d_logT *(logT-(t*m_d_logT+m_logT_min));

        // main contribution
        q += a_table[z][t];
      }
      //
      return q;
    }
    
  protected:
    // temp grid
    double m_logT_min, m_logT_max, m_d_logT;
    
    // metallicity tab
    std::vector<double> m_met_tab;
    
    // cooling function tabs
    std::vector<std::vector<double>> m_ne_tab;
    std::vector<std::vector<double>> m_nt_tab;
    std::vector<std::vector<double>> m_lambda_tab;
  };

} // namespace

#endif
